<%- include partials/header.ejs %>

<div class="map-container">
  <div id="map">

  </div>
</div>


<script src=<%= GMAPAPIKEY %>></script>
<script>
  var map = new google.maps.Map(document.getElementById('map'), {
    center: {lat: 51.509865, lng: -0.118092},
    zoom: 2
  });

  var countries =<%-JSON.stringify(countries)%>

  countries.forEach((country)=>{
    var marker = new google.maps.Marker({
      position: {lat:country.location.coordinates[1] , lng:country.location.coordinates[0]},
      map: map,
      title: country.name
    });
  });

  var layer = new google.maps.FusionTablesLayer({
    query: {
      select: 'geometry',
      from: '1uAfX7SJvGuIo7mn4mXM1H7cGW07kHp5V1KIhlkxm'
    },styles: [{
      polygonOptions: {
        fillColor: '#00FF00',
        fillOpacity: 0.1
      }
    }, {
      where: 'name = Malta',
      polygonOptions: {
        fillColor: '#0000FF',
        fillOpacity: 0.5
      }
    }]
  });

  console.log(layer);
  layer.setMap(map);

  
</script>